<div class="row">
  <div class="col-12 newblock"><h3>Паспортные данные</h3></div>
  <div class="col-4">
    <div class="row">
      <div class="col-6">
        <h6>Фамилия:</h6>
      </div>
      <div class="col-6">{{passport.lastName}}</div>
    </div>
    <div class="row">
      <div class="col-6">
        <h6>Имя:</h6>
      </div>
      <div class="col-6">{{passport.firstName}}</div>
    </div>
    <div class="row">
      <div class="col-6">
        <h6>Отчество:</h6>
      </div>
      <div class="col-6">{{passport.middleName}}</div>
    </div>
    <div class="row">
      <div class="col-6">
        <h6>Серия:</h6>
      </div>
      <div class="col-6">{{passport.series}}</div>
    </div>
    <div class="row">
      <div class="col-6">
        <h6>Номер:</h6>
      </div>
      <div class="col-6">{{passport.number}}</div>
    </div>
  </div>

  <div class="col-5">
    <div class="row">
      <div class="col-6">
        <h6>Личный номер:</h6>
      </div>
      <div class="col-6">{{passport.personalNumber}}</div>
    </div>
    <div class="row">
      <div class="col-6">
        <h6>Дата выдачи:</h6>
      </div>
      <div class="col-6">{{passport.dateOfIssue | date: 'yyyy-MM-dd'}}</div>
    </div>
    <div class="row">
      <div class="col-6">
        <h6>Место выдачи:</h6>
      </div>
      <div class="col-6">{{passport.placeOfIssue}}</div>
    </div>
    <div class="row">
      <div class="col-6">
        <h6>Срок действия:</h6>
      </div>
      <div class="col-6">{{passport.validUntil | date: 'yyyy-MM-dd'}}</div>
    </div>
  </div>
  <div class="col-1" *ngIf="passport.id">
    <button type="button" class="btn-sm btn-primary" (click)="showEdit(content)"
            data-placement="bottom" title="Редактировать паспортные данные">✎
    </button>
  </div>
</div>

<ng-template #content let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="modal-title">Паспортные данные</h4>
    <button type="button" class="close" aria-label="Close" (click)="c('Close click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <form (ngSubmit)="updatePassport()" #updatePassportData="ngForm">
    <div class="modal-body">

      <div class="alert alert-danger" role="alert" *ngIf="errorUpdate">{{errorUpdate}}</div>

      <div class="row">
        <div class="col-6">

          <div class="form-group">
            <label for="lastName">Фамилия:</label>
            <input type="text" class="form-control" id="lastName" name="lastName"
                   [(ngModel)]="editedPassport.lastName"
                   required pattern="[А-яA-z-]{0,20}" #lastName="ngModel">
            <div [hidden]="lastName.valid || lastName.pristine" class="alert alert-danger">
              <div [hidden]="!lastName.hasError('pattern')">Буквы, тире. Максимум 20</div>
              <div [hidden]="!lastName.hasError('required')">Обязательно поле</div>
            </div>
          </div>

          <div class="form-group">
            <label for="firstName">Имя:</label>
            <input type="text" class="form-control" id="firstName" name="firstName"
                   [(ngModel)]="editedPassport.firstName"
                   required pattern="[А-яA-z-]{0,20}" #firstName="ngModel">
            <div [hidden]="firstName.valid || firstName.pristine" class="alert alert-danger">
              <div [hidden]="!firstName.hasError('pattern')">Буквы, тире. Максимум 20</div>
              <div [hidden]="!firstName.hasError('required')">Обязательно поле</div>
            </div>
          </div>

          <div class="form-group">
            <label for="middleName">Отчество:</label>
            <input type="text" id="middleName" name="middleName"
                   [(ngModel)]="editedPassport.middleName" class="form-control"
                   required pattern="[А-яA-z-]{0,20}" #middleName="ngModel">
            <div [hidden]="middleName.valid || middleName.pristine" class="alert alert-danger">
              <div [hidden]="!middleName.hasError('pattern')">Буквы, тире. Максимум 20</div>
              <div [hidden]="!middleName.hasError('required')">Обязательно поле</div>
            </div>
          </div>

          <div class="form-group">
            <label for="series">Серия:</label>
            <input type="text" id="series" name="series" [(ngModel)]="editedPassport.series" class="form-control"
                   required pattern="[А-яA-z]{2}" #series="ngModel">
            <div [hidden]="series.valid || series.pristine" class="alert alert-danger">
              <div [hidden]="!series.hasError('pattern')">Только 2 буквы.</div>
              <div [hidden]="!series.hasError('required')">Обязательно поле</div>
            </div>
          </div>

          <div class="form-group">
            <label for="number">Номер:</label>
            <input type="text" id="number" name="number" [(ngModel)]="editedPassport.number" class="form-control"
                   required pattern="\d{7,8}" #number="ngModel">
            <div [hidden]="number.valid || number.pristine" class="alert alert-danger">
              <div [hidden]="!number.hasError('pattern')">Только цифры.</div>
              <div [hidden]="!number.hasError('required')">Обязательно поле</div>
            </div>
          </div>
        </div>

        <div class="col-6">

          <div class="form-group">
            <label for="personalNumber">Личный номер:</label>
            <input type="text" id="personalNumber" name="personalNumber"
                   [(ngModel)]="editedPassport.personalNumber" class="form-control"
                   required pattern="[А-яA-z0-9]{0,20}" #personalNumber="ngModel">
            <div [hidden]="personalNumber.valid || personalNumber.pristine" class="alert alert-danger">
              <div [hidden]="!personalNumber.hasError('pattern')">Буквы, цифры. Максимум 20</div>
              <div [hidden]="!number.hasError('required')">Обязательно поле</div>
            </div>

          </div>

          <div class="form-group">
            <label for="dateOfIssue">Дата выдачи:</label>
            <div class="input-group">
              <input id="dateOfIssue" class="form-control" placeholder="yyyy-mm-dd"
                     name="dp" [(ngModel)]="dateOfIssue" ngbDatepicker #d="ngbDatepicker"
                     (ngModelChange)="onChangeDateOfIssue(dateOfIssue)" [minDate]="ngbDateOfIssue[0]"
                     [maxDate]="ngbDateOfIssue[1]" required (blur)="touchDateOfIssue()">
              <button class="input-group-addon" (click)="d.toggle()" type="button">
                <img src="../../assets/images/calendar-icon.svg"
                     style="width: 0.5rem; height: 0.5rem; cursor: pointer;"/>
              </button>
            </div>
            <div [hidden]="dateOfIssue != null || !touchedDateOfIssue" class="alert alert-danger">Обязательно поле</div>
          </div>

          <div class="form-group">
            <label for="validUntil">Срок действия:</label>
            <div class="form-group" style="margin-bottom: 0px;">
              <div class="input-group">
                <input class="form-control" id="validUntil" placeholder="yyyy-mm-dd"
                       name="dp1" [(ngModel)]="validUntil" ngbDatepicker #ds="ngbDatepicker"
                       (ngModelChange)="onChangeValidUntil(validUntil)" [minDate]="ngbValidUntil[0]"
                       [maxDate]="ngbValidUntil[1]" required (blur)="touchValidUntil()">
                <button class="input-group-addon" (click)="ds.toggle()" type="button">
                  <img src="../../assets/images/calendar-icon.svg"
                       style="width: 0.5rem; height: 0.5rem; cursor: pointer;"/>
                </button>
              </div>
              <div [hidden]="validUntil != null || !touchedValidUntil" class="alert alert-danger">Обязательно поле</div>
            </div>
          </div>

          <div class="form-group">
            <label for="placeOfIssue">Место выдачи:</label>
            <input type="text" id="placeOfIssue" name="placeOfIssue" [(ngModel)]="editedPassport.placeOfIssue"
                   class="form-control" required #placeOfIssue="ngModel">
            <div [hidden]="placeOfIssue.valid || placeOfIssue.pristine" class="alert alert-danger">
              <div [hidden]="!placeOfIssue.hasError('required')">Обязательно поле</div>
            </div>
          </div>
        </div>
      </div>

    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="c('Close click')">Закрыть</button>
      <button type="submit" class="btn btn-primary" [disabled]="!updatePassportData.form.valid">Сохранить</button>
    </div>
  </form>
</ng-template>
